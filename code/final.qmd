---
title: "final"
format: html
---

Github repo: https://github.com/kathrynk04/ENVS-193DS_spring-2025_final.git

```{r message=FALSE}
library(tidyverse)
library(janitor)
library(here)

sst <- read_csv(
  here("data", "SST_update2023.csv"))
```

## Problem 1: Research writing

# a. Transparent statistical methods

In part 1, they used Pearson's r. In part 2, they used a one-way ANOVA.

# b. More information needed

Another test that should be included is Tukey's HSD in order to determine which source group means are different from each other. A piece of additional information that should be included is the effect size, which is the eta squared, to determine how large of an effect the source had on average nitrogen load.

# c. Suggestions for rewriting

We found a relationship (Pearson's r = correlation coefficient) between distance from headwater and annual total nitrogen load, where distance from headwater significantly predicted annual total nitrogen load (F(degrees of freedom, 1) = F-statistic, p = 0.03, $\alpha$ = significance level). We found a difference between sources in average nitrogen load (one-way ANOvA, F(4, within groups df) = F-statistic, p = 0.02, $\alpha$ = significance level).

## Problem 2: Data visualization

# a. Cleaning and summarizing

```{r message=FALSE}
sst_clean <- sst |> # storing the data into a new cleaned data frame
  clean_names() |> #
  mutate(year = year(date),
         month = month(date)) |>
  filter(year > 2017) |>
  mutate(month = case_match(as.character(month),
                            "1" ~ "Jan",
                            "2" ~ "Feb",
                            "3" ~ "Mar",
                            "4" ~ "Apr",
                            "5" ~ "May",
                            "6" ~ "Jun",
                            "7" ~ "Jul",
                            "8" ~ "Aug",
                            "9" ~ "Sep",
                            "10" ~ "Oct",
                            "11" ~ "Nov",
                            "12" ~ "Dec"),
         month = factor(month,
                        levels = c("Jan",
                                   "Feb",
                                   "Mar",
                                   "Apr",
                                   "May",
                                   "Jun",
                                   "Jul",
                                   "Aug",
                                   "Sep",
                                   "Oct",
                                   "Nov",
                                   "Dec"),
                        ordered = TRUE),
         year = factor(as.character(year),
                       levels = as.character(2018:2023),
                       ordered = FALSE)) |>
  group_by(year, month) |>
  summarize(mean_monthly_sst = mean(temp),
            .groups = "drop") |>
  mutate(mean_monthly_sst = round(mean_monthly_sst, 1)) # Round result

str(sst_clean)
```

# b. Visualize the data

```{r message=FALSE}
ggplot(data = sst_clean,
       aes(x = month,
           y = mean_monthly_sst,
           color = year,
           group = year)) +
  geom_point() +
  geom_line() +
  scale_color_manual(values = c("2018" = "red", # assigning different colors to each year
                                "2019" = "orange",
                                "2020" = "yellow",
                                "2021" = "green",
                                "2022" = "blue",
                                "2023" = "purple")) +
  labs(x = "Month", # labeling the x-axis as "Month"
       y = "Mean monthly sea surface temperature (Â°C)") +
  theme_bw() + # making the theme black and white
  theme(panel.grid = element_blank(),
        legend.location = "plot")
```

